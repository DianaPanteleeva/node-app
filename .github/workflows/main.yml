name: ðŸš€ Docker CI/CD

on:
  push:
    branches: [ main ]

jobs:
  docker:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v3
      
      - name: ðŸ”§ Setup Docker
        run: |
          # Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ Dockerfile Ð½Ð° Ð»ÐµÑ‚Ñƒ
          cat > Dockerfile << 'EOF'
          FROM node:18-alpine
          WORKDIR /app
          COPY package*.json ./
          RUN npm install
          COPY . .
          EXPOSE 4000
          CMD ["npm", "start"]
          EOF
          
          echo "âœ… Dockerfile created:"
          cat Dockerfile
      
      - name: ðŸ” Login to DockerHub
        uses: docker/login-action@v2
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}
      
      - name: ðŸ³ Build and Push
        uses: docker/build-push-action@v4
        with:
          context: .
          push: true
          tags: ${{ secrets.DOCKERHUB_USERNAME }}/node-app:v1
